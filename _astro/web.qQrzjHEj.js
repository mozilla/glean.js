var f;(function(t){t.Debug="debug",t.Info="info",t.Warn="warn",t.Error="error",t.Trace="trace"})(f||(f={}));function g(t,e,n=f.Debug){const r=`(Glean.${t})`;Array.isArray(e)?console[n](r,...e):console[n](r,e)}const Xt=1e4;var yt;(function(t){t[t.RecoverableFailure=0]="RecoverableFailure",t[t.UnrecoverableFailure=1]="UnrecoverableFailure",t[t.Success=2]="Success"})(yt||(yt={}));class Me{constructor(e,n){this.result=e,this.status=n}}class ct{}const We="platform.browser.FetchUploader";class fn extends ct{constructor(){super(...arguments),this.timeoutMs=Xt}async post(e,n,r=!0){const i=new AbortController,a=setTimeout(()=>i.abort(),this.timeoutMs),o=n.asCompressedPayload();let c;try{c=await fetch(e.toString(),{headers:o.headers,method:"POST",body:o.payload,keepalive:r,credentials:"omit",signal:i.signal,redirect:"error"})}catch(l){if(l instanceof DOMException)g(We,[`Timeout while attempting to upload ping.
`,l],f.Error);else if(l instanceof TypeError){if(r)return this.post(e,o,!1);g(We,[`Network error while attempting to upload ping.
`,l],f.Error)}else g(We,[`Unknown error while attempting to upload ping.
`,l],f.Error);return clearTimeout(a),new Me(0)}return clearTimeout(a),new Me(2,c.status)}supportsCustomHeaders(){return!0}}const gn=new fn,hn="platform.browser.SendBeaconUploader";class pn extends ct{constructor(){super(...arguments),this.timeoutMs=Xt}async post(e,n,r=!0){return navigator.sendBeacon(e,n.payload)?new Me(2,200):(r&&g(hn,"The `sendBeacon` call was not serviced by the browser. Deleting data.",f.Error),new Me(1))}supportsCustomHeaders(){return!1}}const mn=new pn,Z="core.Context";class s{constructor(){this.initialized=!1,this.testing=!1,this.supportedMetrics={},this.startTime=new Date}static get instance(){return s._instance||(s._instance=new s),s._instance}static testUninitialize(){s._instance=void 0}static get uploadEnabled(){return typeof s.instance.uploadEnabled>"u"&&g(Z,["Attempted to access Context.uploadEnabled before it was set. This may cause unexpected behaviour."],f.Trace),s.instance.uploadEnabled}static set uploadEnabled(e){s.instance.uploadEnabled=e}static get metricsDatabase(){return typeof s.instance.metricsDatabase>"u"&&g(Z,["Attempted to access Context.metricsDatabase before it was set. This may cause unexpected behaviour."],f.Trace),s.instance.metricsDatabase}static set metricsDatabase(e){s.instance.metricsDatabase=e}static get eventsDatabase(){return typeof s.instance.eventsDatabase>"u"&&g(Z,["Attempted to access Context.eventsDatabase before it was set. This may cause unexpected behaviour."],f.Trace),s.instance.eventsDatabase}static set eventsDatabase(e){s.instance.eventsDatabase=e}static get pingsDatabase(){return typeof s.instance.pingsDatabase>"u"&&g(Z,["Attempted to access Context.pingsDatabase before it was set. This may cause unexpected behaviour."],f.Trace),s.instance.pingsDatabase}static set pingsDatabase(e){s.instance.pingsDatabase=e}static get errorManager(){return typeof s.instance.errorManager>"u"&&g(Z,["Attempted to access Context.errorManager before it was set. This may cause unexpected behaviour."],f.Trace),s.instance.errorManager}static set errorManager(e){s.instance.errorManager=e}static get applicationId(){return typeof s.instance.applicationId>"u"&&g(Z,["Attempted to access Context.applicationId before it was set. This may cause unexpected behaviour."],f.Trace),s.instance.applicationId}static set applicationId(e){s.instance.applicationId=e}static get initialized(){return s.instance.initialized}static set initialized(e){s.instance.initialized=e}static get config(){return typeof s.instance.config>"u"&&g(Z,["Attempted to access Context.config before it was set. This may cause unexpected behaviour."],f.Trace),s.instance.config}static set config(e){s.instance.config=e}static get startTime(){return s.instance.startTime}static get testing(){return s.instance.testing}static set testing(e){s.instance.testing=e}static get corePings(){return s.instance.corePings}static set corePings(e){s.instance.corePings=e}static get coreMetrics(){return s.instance.coreMetrics}static set coreMetrics(e){s.instance.coreMetrics=e}static set platform(e){s.instance.platform=e}static get platform(){return typeof s.instance.platform>"u"&&g(Z,["Attempted to access Context.platform before it was set. This may cause unexpected behaviour."],f.Trace),s.instance.platform}static isPlatformSet(){return!!s.instance.platform}static getSupportedMetric(e){return s.instance.supportedMetrics[e]}static addSupportedMetric(e,n){e in s.instance.supportedMetrics||(s.instance.supportedMetrics[e]=n)}}const Et="platform.browser.SendBeaconFallbackUploader";class bn extends ct{constructor(){super(...arguments),this.fetchUploader=gn,this.sendBeaconUploader=mn}async post(e,n){var r,i;if(!(!((r=s.config)===null||r===void 0)&&r.sourceTags)&&!(!((i=s.config)===null||i===void 0)&&i.debugViewTag)&&navigator&&navigator.sendBeacon){const o=await this.sendBeaconUploader.post(e,n,!1);if(o.result==2)return o;g(Et,"The `sendBeacon` call was not serviced by the browser. Falling back to the `fetch` uploader.",f.Warn)}else g(Et,"`sendBeacon` is not available. Falling back to the `fetch` uploader.",f.Warn);return this.fetchUploader.post(e,n)}supportsCustomHeaders(){return!1}}const wn=new bn,vn={os(){let t;return navigator&&navigator.userAgent?t=navigator.userAgent:t="Unknown",t.includes("Windows")?"Windows":/tvOS/i.test(t)?"TvOS":/Watch( OS)?/i.test(t)?"WatchOS":/iPhone|iPad|iOS/i.test(t)?"iOS":/Mac OS X|macOS/i.test(t)?"Darwin":/Android/i.test(t)?"Android":/CrOS/i.test(t)?"ChromeOS":/WebOS/i.test(t)?"WebOS":/Linux/i.test(t)?"Linux":/OpenBSD/i.test(t)?"OpenBSD":/FreeBSD/i.test(t)?"FreeBSD":/NetBSD/i.test(t)?"NetBSD":/SunOS/i.test(t)?"SunOS":/AIX/i.test(t)?"IBM_AIX":"Unknown"},osVersion(){return"Unknown"},arch(){return"Unknown"},locale(){return navigator&&navigator.language?navigator.language:"und"}},yn=vn;let Ue;const En=new Uint8Array(16);function Sn(){if(!Ue&&(Ue=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Ue))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ue(En)}const D=[];for(let t=0;t<256;++t)D.push((t+256).toString(16).slice(1));function Tn(t,e=0){return D[t[e+0]]+D[t[e+1]]+D[t[e+2]]+D[t[e+3]]+"-"+D[t[e+4]]+D[t[e+5]]+"-"+D[t[e+6]]+D[t[e+7]]+"-"+D[t[e+8]]+D[t[e+9]]+"-"+D[t[e+10]]+D[t[e+11]]+D[t[e+12]]+D[t[e+13]]+D[t[e+14]]+D[t[e+15]]}const In=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),St={randomUUID:In};function Dn(t,e,n){if(St.randomUUID&&!e&&!t)return St.randomUUID();t=t||{};const r=t.random||(t.rng||Sn)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let i=0;i<16;++i)e[n+i]=r[i];return e}return Tn(r)}var K;(function(t){t.InvalidValue="invalid_value",t.InvalidLabel="invalid_label",t.InvalidState="invalid_state",t.InvalidOverflow="invalid_overflow",t.InvalidType="invalid_type"})(K||(K={}));var S;(function(t){t[t.Success=0]="Success",t[t.Error=1]="Error"})(S||(S={}));class Y extends Error{constructor(e,n=K.InvalidType){super(e),this.type=n,this.name="MetricValidationError"}recordError(e){s.errorManager.record(e,this.type,this.message)}}class we{constructor(e){this.inner=this.validateOrThrow(e)}get(){return this.inner}set(e){this.inner=e}validateOrThrow(e){const n=this.validate(e);if(n.type===S.Error)throw new Y(n.errorMessage,n.errorType);return e}}const Pn="core.utils";function Ae(t){if(L(t)||Ne(t)||Oe(t))return!0;if(U(t)){if(Object.keys(t).length===0)return!0;for(const e in t)return Ae(t[e])}return Array.isArray(t)?t.every(e=>Ae(e)):!1}function U(t){return typeof t=="object"&&t!==null&&t.constructor===Object}function X(t){return typeof t>"u"}function L(t){return typeof t=="string"}function Ne(t){return typeof t=="boolean"}function Oe(t){return typeof t=="number"&&!isNaN(t)}function Kt(t){return Oe(t)&&Number.isInteger(t)}function _n(t){if(t.toLowerCase()==="true")return!0;if(t.toLowerCase()==="false")return!1}function Mn(t){return t.replace(/[^a-z0-9]+/gi,"-").toLowerCase()}function An(t){return/^(http|https):\/\/[a-zA-Z0-9._-]+(:\d+){0,1}(\/{0,1})$/i.test(t)}function Tt(t){return/^[a-z0-9-]{1,20}$/i.test(t)}function Re(){return typeof crypto<"u"?Dn():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}function Ye(){const t=typeof performance>"u"?Date.now():performance.now();return Math.round(t)}function Ht(t,e,n){if(!L(e))throw new Y(`Expected string, got ${JSON.stringify(e)}`);const r=new TextEncoder,i=new TextDecoder("utf-8"),o=r.encode(e).slice(0,n),c=i.decode(o);return c!==e&&s.errorManager.record(t,K.InvalidOverflow,`Value length ${new Blob([e]).size} exceeds maximum of ${e.length} bytes.`),c}function oe(t,e=Pn){return s.testing?!0:(g(e,[`Attempted to access test only method \`${t||"unknown"}\`,`,"but Glean is not in testing mode. Ignoring. Make sure to put Glean in testing mode","before accessing such methods, by calling `testResetGlean`."],f.Error),!1)}function $n(...t){let e=t.reduce((n,r)=>n+r,0);return e>Number.MAX_SAFE_INTEGER&&(e=Number.MAX_SAFE_INTEGER),e}function Pe(){return typeof window>"u"}function On(t,e){if(e.length===0)throw Error("The index must contain at least one property to get.");let n=t;for(const r of e)if(U(n)&&r in n){const i=n[r];Ae(i)&&(n=i)}else return;return n}function xn(t,e,n){if(e.length===0)throw Error("The index must contain at least one property to update.");const r={...t};let i=r;for(const l of e.slice(0,e.length-1))U(i[l])||(i[l]={}),i=i[l];const a=e[e.length-1],o=i[a],c=n(o);return i[a]=c,r}function Un(t,e){if(e.length===0)return{};const n={...t};let r=n;for(const a of e.slice(0,e.length-1)){const o=r[a];if(U(o))r=o;else throw Error(`Attempted to delete an entry from an inexistent index: ${JSON.stringify(e)}.`)}const i=e[e.length-1];return delete r[i],n}const Le="platform.web.Storage";class Ln{constructor(e){this.rootKey=e,this.logTag=`${Le}.${e}`}get(e=[]){if(Pe())return;let n;try{const r=localStorage.getItem(this.rootKey)||"{}",i=JSON.parse(r);e.length>0?n=On(i,e):n=Object.keys(i).length===0?void 0:i}catch(r){g(Le,["Unable to fetch value from local storage.",r],f.Error)}return this.shouldUpdateSession(e)&&s.coreMetrics.updateSessionInfo(),n}update(e,n){if(!Pe()){try{const r=localStorage.getItem(this.rootKey)||"{}",i=JSON.parse(r),a=xn(i,e,n);localStorage.setItem(this.rootKey,JSON.stringify(a))}catch(r){g(Le,["Unable to update value from local storage.",r],f.Error)}this.shouldUpdateSession(e)&&s.coreMetrics.updateSessionInfo()}}delete(e){if(!Pe()){try{const n=localStorage.getItem(this.rootKey)||"{}",r=JSON.parse(n);if(e.length===0)localStorage.removeItem(this.rootKey);else try{const i=Un(r,e);localStorage.setItem(this.rootKey,JSON.stringify(i))}catch(i){g(this.logTag,[`Error attempting to delete key ${e.toString()} from storage. Ignoring.`,i],f.Warn)}}catch(n){g(Le,["Unable to delete value from storage.",n],f.Error)}this.shouldUpdateSession(e)&&s.coreMetrics.updateSessionInfo()}}shouldUpdateSession(e){return!e.includes("session_id")&&!e.includes("session_count")}}const Gn=Ln,Nn={Storage:Gn,uploader:wn,info:yn,timer:{setTimeout,clearTimeout},name:"web"},Rn=Nn,Cn=1,Yt="5.0.0",Ce="glean_ping_info",he="glean_client_info",Qe="c0ffeec0-ffee-c0ff-eec0-ffeec0ffeec0",zn="https://incoming.telemetry.mozilla.org",lt="deletion-request",re="events",It=5,me="#glean_reference_time",De="#glean_execution_counter",Vn=[De,me],qe="core.Config",Fn=1;class Bn{constructor(e){var n;if(this.channel=e?.channel,this.appBuild=e?.appBuild,this.appDisplayVersion=e?.appDisplayVersion,this.buildDate=e?.buildDate,this.maxEvents=e?.maxEvents||Fn,this.migrateFromLegacyStorage=e?.migrateFromLegacyStorage,this.enableAutoPageLoadEvents=e?.enableAutoPageLoadEvents,this.enableAutoElementClickEvents=e?.enableAutoElementClickEvents,this.experimentationId=e?.experimentationId,this.sessionLengthInMinutesOverride=e?.sessionLengthInMinutesOverride,this.debug={},e?.serverEndpoint&&!An(e.serverEndpoint))throw new Error(`Unable to initialize Glean, serverEndpoint ${e.serverEndpoint} is an invalid URL.`);if(!s.testing&&(!((n=e?.serverEndpoint)===null||n===void 0)&&n.startsWith("http:")))throw new Error(`Unable to initialize Glean, serverEndpoint ${e.serverEndpoint} must use the HTTPS protocol.`);this.serverEndpoint=e&&e.serverEndpoint?e.serverEndpoint:zn,this.httpClient=e?.httpClient}get logPings(){return this.debug.logPings||!1}set logPings(e){this.debug.logPings=e}get debugViewTag(){return this.debug.debugViewTag}set debugViewTag(e){if(!Tt(e||"")){g(qe,[`"${e||""}" is not a valid \`debugViewTag\` value.`,"Please make sure the value passed satisfies the regex `^[a-zA-Z0-9-]{1,20}$`."],f.Error);return}this.debug.debugViewTag=e}get sourceTags(){return this.debug.sourceTags}set sourceTags(e){if(!e||e.length<1||e.length>It){g(qe,`A list of tags cannot contain more than ${It} elements or less than one.`,f.Error);return}for(const n of e){if(n.startsWith("glean")){g(qe,"Tags starting with `glean` are reserved and must not be used.",f.Error);return}if(!Tt(n))return}this.debug.sourceTags=e}}var A=Uint8Array,x=Uint16Array,ut=Int32Array,dt=new A([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ft=new A([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Dt=new A([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Qt=function(t,e){for(var n=new x(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];for(var i=new ut(n[30]),r=1;r<30;++r)for(var a=n[r];a<n[r+1];++a)i[a]=a-n[r]<<5|r;return{b:n,r:i}},Zt=Qt(dt,2),kn=Zt.b,Ze=Zt.r;kn[28]=258,Ze[258]=28;var jn=Qt(ft,0),Pt=jn.r,et=new x(32768);for(var E=0;E<32768;++E){var ee=(E&43690)>>1|(E&21845)<<1;ee=(ee&52428)>>2|(ee&13107)<<2,ee=(ee&61680)>>4|(ee&3855)<<4,et[E]=((ee&65280)>>8|(ee&255)<<8)>>1}var _e=function(t,e,n){for(var r=t.length,i=0,a=new x(e);i<r;++i)t[i]&&++a[t[i]-1];var o=new x(e);for(i=1;i<e;++i)o[i]=o[i-1]+a[i-1]<<1;var c;if(n){c=new x(1<<e);var l=15-e;for(i=0;i<r;++i)if(t[i])for(var d=i<<4|t[i],u=e-t[i],m=o[t[i]-1]++<<u,b=m|(1<<u)-1;m<=b;++m)c[et[m]>>l]=d}else for(c=new x(r),i=0;i<r;++i)t[i]&&(c[i]=et[o[t[i]-1]++]>>15-t[i]);return c},ae=new A(288);for(var E=0;E<144;++E)ae[E]=8;for(var E=144;E<256;++E)ae[E]=9;for(var E=256;E<280;++E)ae[E]=7;for(var E=280;E<288;++E)ae[E]=8;var ze=new A(32);for(var E=0;E<32;++E)ze[E]=5;var Wn=_e(ae,9,0),qn=_e(ze,5,0),en=function(t){return(t+7)/8|0},tn=function(t,e,n){return(e==null||e<0)&&(e=0),(n==null||n>t.length)&&(n=t.length),new A(t.subarray(e,n))},H=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8},ye=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8,t[r+2]|=n>>16},Je=function(t,e){for(var n=[],r=0;r<t.length;++r)t[r]&&n.push({s:r,f:t[r]});var i=n.length,a=n.slice();if(!i)return{t:rn,l:0};if(i==1){var o=new A(n[0].s+1);return o[n[0].s]=1,{t:o,l:1}}n.sort(function(N,C){return N.f-C.f}),n.push({s:-1,f:25001});var c=n[0],l=n[1],d=0,u=1,m=2;for(n[0]={s:-1,f:c.f+l.f,l:c,r:l};u!=i-1;)c=n[n[d].f<n[m].f?d++:m++],l=n[d!=u&&n[d].f<n[m].f?d++:m++],n[u++]={s:-1,f:c.f+l.f,l:c,r:l};for(var b=a[0].s,r=1;r<i;++r)a[r].s>b&&(b=a[r].s);var h=new x(b+1),v=tt(n[u-1],h,0);if(v>e){var r=0,p=0,T=v-e,j=1<<T;for(a.sort(function(C,M){return h[M.s]-h[C.s]||C.f-M.f});r<i;++r){var G=a[r].s;if(h[G]>e)p+=j-(1<<v-h[G]),h[G]=e;else break}for(p>>=T;p>0;){var ie=a[r].s;h[ie]<e?p-=1<<e-h[ie]++-1:++r}for(;r>=0&&p;--r){var R=a[r].s;h[R]==e&&(--h[R],++p)}v=e}return{t:new A(h),l:v}},tt=function(t,e,n){return t.s==-1?Math.max(tt(t.l,e,n+1),tt(t.r,e,n+1)):e[t.s]=n},_t=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new x(++e),r=0,i=t[0],a=1,o=function(l){n[r++]=l},c=1;c<=e;++c)if(t[c]==i&&c!=e)++a;else{if(!i&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(i),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(i);a=1,i=t[c]}return{c:n.subarray(0,r),n:e}},Ee=function(t,e){for(var n=0,r=0;r<e.length;++r)n+=t[r]*e[r];return n},nn=function(t,e,n){var r=n.length,i=en(e+2);t[i]=r&255,t[i+1]=r>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var a=0;a<r;++a)t[i+a+4]=n[a];return(i+4+r)*8},Mt=function(t,e,n,r,i,a,o,c,l,d,u){H(e,u++,n),++i[256];for(var m=Je(i,15),b=m.t,h=m.l,v=Je(a,15),p=v.t,T=v.l,j=_t(b),G=j.c,ie=j.n,R=_t(p),N=R.c,C=R.n,M=new x(19),y=0;y<G.length;++y)++M[G[y]&31];for(var y=0;y<N.length;++y)++M[N[y]&31];for(var w=Je(M,7),$=w.t,ce=w.l,O=19;O>4&&!$[Dt[O-1]];--O);var le=d+5<<3,z=Ee(i,ae)+Ee(a,ze)+o,V=Ee(i,b)+Ee(a,p)+o+14+3*O+Ee(M,$)+2*M[16]+3*M[17]+7*M[18];if(l>=0&&le<=z&&le<=V)return nn(e,u,t.subarray(l,l+d));var W,I,F,Q;if(H(e,u,1+(V<z)),u+=2,V<z){W=_e(b,h,0),I=b,F=_e(p,T,0),Q=p;var Fe=_e($,ce,0);H(e,u,ie-257),H(e,u+5,C-1),H(e,u+10,O-4),u+=14;for(var y=0;y<O;++y)H(e,u+3*y,$[Dt[y]]);u+=3*O;for(var q=[G,N],ve=0;ve<2;++ve)for(var ue=q[ve],y=0;y<ue.length;++y){var J=ue[y]&31;H(e,u,Fe[J]),u+=$[J],J>15&&(H(e,u,ue[y]>>5&127),u+=ue[y]>>12)}}else W=Wn,I=ae,F=qn,Q=ze;for(var y=0;y<c;++y){var _=r[y];if(_>255){var J=_>>18&31;ye(e,u,W[J+257]),u+=I[J+257],J>7&&(H(e,u,_>>23&31),u+=dt[J]);var de=_&31;ye(e,u,F[de]),u+=Q[de],de>3&&(ye(e,u,_>>5&8191),u+=ft[de])}else ye(e,u,W[_]),u+=I[_]}return ye(e,u,W[256]),u+I[256]},Jn=new ut([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),rn=new A(0),Xn=function(t,e,n,r,i,a){var o=a.z||t.length,c=new A(r+o+5*(1+Math.ceil(o/7e3))+i),l=c.subarray(r,c.length-i),d=a.l,u=(a.r||0)&7;if(e){u&&(l[0]=a.r>>3);for(var m=Jn[e-1],b=m>>13,h=m&8191,v=(1<<n)-1,p=a.p||new x(32768),T=a.h||new x(v+1),j=Math.ceil(n/3),G=2*j,ie=function(je){return(t[je]^t[je+1]<<j^t[je+2]<<G)&v},R=new ut(25e3),N=new x(288),C=new x(32),M=0,y=0,w=a.i||0,$=0,ce=a.w||0,O=0;w+2<o;++w){var le=ie(w),z=w&32767,V=T[le];if(p[z]=V,T[le]=z,ce<=w){var W=o-w;if((M>7e3||$>24576)&&(W>423||!d)){u=Mt(t,l,0,R,N,C,y,$,O,w-O,u),$=M=y=0,O=w;for(var I=0;I<286;++I)N[I]=0;for(var I=0;I<30;++I)C[I]=0}var F=2,Q=0,Fe=h,q=z-V&32767;if(W>2&&le==ie(w-q))for(var ve=Math.min(b,W)-1,ue=Math.min(32767,w),J=Math.min(258,W);q<=ue&&--Fe&&z!=V;){if(t[w+F]==t[w+F-q]){for(var _=0;_<J&&t[w+_]==t[w+_-q];++_);if(_>F){if(F=_,Q=q,_>ve)break;for(var de=Math.min(q,_-2),mt=0,I=0;I<de;++I){var Be=w-q+I&32767,dn=p[Be],bt=Be-dn&32767;bt>mt&&(mt=bt,V=Be)}}}z=V,V=p[z],q+=z-V&32767}if(Q){R[$++]=268435456|Ze[F]<<18|Pt[Q];var wt=Ze[F]&31,vt=Pt[Q]&31;y+=dt[wt]+ft[vt],++N[257+wt],++C[vt],ce=w+F,++M}else R[$++]=t[w],++N[t[w]]}}for(w=Math.max(w,ce);w<o;++w)R[$++]=t[w],++N[t[w]];u=Mt(t,l,d,R,N,C,y,$,O,w-O,u),d||(a.r=u&7|l[u/8|0]<<3,u-=7,a.h=T,a.p=p,a.i=w,a.w=ce)}else{for(var w=a.w||0;w<o+d;w+=65535){var ke=w+65535;ke>=o&&(l[u/8|0]=d,ke=o),u=nn(l,u+1,t.subarray(w,ke))}a.i=o}return tn(c,0,r+en(u)+i)},Kn=function(){for(var t=new Int32Array(256),e=0;e<256;++e){for(var n=e,r=9;--r;)n=(n&1&&-306674912)^n>>>1;t[e]=n}return t}(),Hn=function(){var t=-1;return{p:function(e){for(var n=t,r=0;r<e.length;++r)n=Kn[n&255^e[r]]^n>>>8;t=n},d:function(){return~t}}},Yn=function(t,e,n,r,i){if(!i&&(i={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),o=new A(a.length+t.length);o.set(a),o.set(t,a.length),t=o,i.w=a.length}return Xn(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,n,r,i)},nt=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},Qn=function(t,e){var n=e.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=e.level<2?4:e.level==9?2:0,t[9]=3,e.mtime!=0&&nt(t,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),n){t[3]=8;for(var r=0;r<=n.length;++r)t[r+10]=n.charCodeAt(r)}},Zn=function(t){return 10+(t.filename?t.filename.length+1:0)};function er(t,e){e||(e={});var n=Hn(),r=t.length;n.p(t);var i=Yn(t,e,Zn(e),8),a=i.length;return Qn(i,e),nt(i,a-8,n.d()),nt(i,a-4,r),i}var At=typeof TextEncoder<"u"&&new TextEncoder,tr=typeof TextDecoder<"u"&&new TextDecoder,nr=0;try{tr.decode(rn,{stream:!0}),nr=1}catch{}function sn(t,e){if(e){for(var n=new A(t.length),r=0;r<t.length;++r)n[r]=t.charCodeAt(r);return n}if(At)return At.encode(t);for(var i=t.length,a=new A(t.length+(t.length>>1)),o=0,c=function(u){a[o++]=u},r=0;r<i;++r){if(o+5>a.length){var l=new A(o+8+(i-r<<1));l.set(a),a=l}var d=t.charCodeAt(r);d<128||e?c(d):d<2048?(c(192|d>>6),c(128|d&63)):d>55295&&d<57344?(d=65536+(d&1047552)|t.charCodeAt(++r)&1023,c(240|d>>18),c(128|d>>12&63),c(128|d>>6&63),c(128|d&63)):(c(224|d>>12),c(128|d>>6&63),c(128|d&63))}return tn(a,0,o)}const Xe="core.Pings.Database";class rr{constructor(){this.store=new s.platform.Storage("pings")}attachObserver(e){this.observer=e}recordPing(e,n,r,i){const a={collectionDate:new Date().toISOString(),path:e,payload:r};i&&(a.headers=i),this.store.update([n],()=>a),this.observer&&this.observer.update(n,a)}deletePing(e){this.store.delete([e])}getAllPings(){const e=this.store.get(),n={};if(U(e))for(const r in e){const i=e[r];sr(i)?n[r]=i:(g(Xe,`Unexpected data found in pings database: ${JSON.stringify(i,null,2)}. Deleting.`,f.Warn),this.store.delete([r]))}return ar(n)}scanPendingPings(){if(!this.observer)return;const e=this.getAllPingsWithoutSurplus();for(const[n,r]of e)this.observer.update(n,r)}clearAll(){this.store.delete([])}getAllPingsWithoutSurplus(e=250,n=10*1024*1024){const r=this.getAllPings(),i=r.filter(([m,b])=>!rt(b)).reverse(),a=r.filter(([m,b])=>rt(b)),o=i.length;o>e&&g(Xe,[`More than ${e} pending pings in the pings database,`,`will delete ${o-e} old pings.`],f.Warn);let c=!1,l=0,d=0;const u=[];for(const[m,b]of i)l++,d+=ir(b),!c&&d>n&&(g(Xe,[`Pending pings database has reached the size quota of ${n} bytes,`,"outstanding pings will be deleted."],f.Warn),c=!0),l>e&&(c=!0),c?this.deletePing(m):u.unshift([m,b]);return[...a,...u]}}function rt(t){return t.path.split("/")[3]===lt}function ir(t){return sn(JSON.stringify(t)).length}function sr(t){if(U(t)){const e="collectionDate"in t&&L(t.collectionDate)&&Oe(new Date(t.collectionDate).getTime()),n="path"in t&&L(t.path),r="payload"in t&&Ae(t.payload)&&U(t.payload),i=!("headers"in t)||Ae(t.headers)&&U(t.headers);return!(!e||!n||!r||!i)}return!1}function ar(t){return Object.entries(t).sort(([e,{collectionDate:n}],[r,{collectionDate:i}])=>{const a=new Date(n).getTime(),o=new Date(i).getTime();return a-o})}const or=60*1e3,cr=40;var $t;(function(t){t[t.Incrementing=0]="Incrementing",t[t.Throttled=1]="Throttled"})($t||($t={}));class lr{constructor(e=or,n=cr,r=0,i){this.interval=e,this.maxCount=n,this.count=r,this.started=i}get elapsed(){if(X(this.started))return NaN;const n=Ye()-this.started;return n<0?NaN:n}reset(){this.started=Ye(),this.count=0}shouldReset(){return!!(X(this.started)||isNaN(this.elapsed)||this.elapsed>this.interval)}getState(){this.shouldReset()&&this.reset();const e=this.interval-this.elapsed;return this.count>=this.maxCount?{state:1,remainingTime:e}:(this.count++,{state:0})}}class an{constructor(e=3,n=3,r=1024*1024){this.maxWaitAttempts=e,this.maxRecoverableFailures=n,this.maxPingBodySize=r}}class on extends Error{constructor(e){super(e),this.name="PingBodyOverflow"}}class gt{constructor(e,n,r,i){this.identifier=e,this.headers=n,this.payload=r,this.maxBodySize=i}asCompressedPayload(){if(this.headers["Content-Encoding"]=="gzip")return this;const e=sn(this.payload);let n;const r=this.headers;try{n=er(e),r["Content-Encoding"]="gzip",r["Content-Length"]=n.length.toString()}catch{return this}if(n.length>this.maxBodySize)throw new on(`Body for ping ${this.identifier} exceeds ${this.maxBodySize} bytes. Discarding.`);return new gt(this.identifier,r,n,this.maxBodySize)}}const Ot="core.Upload.PingUploadWorker";class ur{constructor(e,n,r=new an){this.uploader=e,this.serverEndpoint=n,this.policy=r,this.isBlocking=!1}buildPingRequest(e){let n=e.headers||{};n={...e.headers,"Content-Type":"application/json; charset=utf-8",Date:new Date().toISOString(),"X-Telemetry-Agent":`Glean/${Yt} (JS on ${s.platform.info.os()})`};const r=JSON.stringify(e.payload);if(r.length>this.policy.maxPingBodySize)throw new on(`Body for ping ${e.identifier} exceeds ${this.policy.maxPingBodySize}bytes. Discarding.`);return n["Content-Length"]=r.length.toString(),new gt(e.identifier,n,r,this.policy.maxPingBodySize)}async attemptPingUpload(e){try{const n=this.buildPingRequest(e);return this.uploader.post(`${this.serverEndpoint}${e.path}`,n)}catch(n){return g(Ot,["Error trying to build or post ping request:",n],f.Warn),new Me(1)}}work(e,n){for(;;)try{const r=e();switch(r.type){case"upload":{if(this.isBlocking)return;this.attemptPingUpload(r.ping).then(i=>{n(r.ping,i)}).catch(i=>{console.log(i)});continue}case"done":return}}catch(r){g(Ot,["IMPOSSIBLE: Something went wrong while processing ping upload tasks.",r],f.Error)}}blockUploading(){this.isBlocking=!0}resumeUploading(){this.isBlocking=!1}}var xt;(function(t){t.Done="done",t.Wait="wait",t.Upload="upload"})(xt||(xt={}));const Se={done:()=>({type:"done"}),wait:t=>({type:"wait",remainingTime:t}),upload:t=>({type:"upload",ping:t})},Te="core.Upload.PingUploadManager";class dr{constructor(e,n,r=new an,i=new lr){this.pingsDatabase=n,this.policy=r,this.rateLimiter=i,this.recoverableFailureCount=0,this.waitAttemptCount=0,this.queue=[],this.processing=new Set,this.worker=new ur(e.httpClient?e.httpClient:s.platform.uploader,e.serverEndpoint,r),n.attachObserver(this)}getUploadTask(){const e=this.getUploadTaskInternal();return e.type!=="wait"&&this.waitAttemptCount>0&&(this.waitAttemptCount=0),e.type!=="upload"&&this.recoverableFailureCount>0&&(this.recoverableFailureCount=0),e}processPingUploadResponse(e,n){const{identifier:r}=e;this.processing.has(r)&&this.processing.delete(r);const{status:i,result:a}=n;if(i&&i>=200&&i<300){g(Te,`Ping ${r} successfully sent ${i}.`,f.Info),this.pingsDatabase.deletePing(r);return}if(a===1||i&&i>=400&&i<500){g(Te,`Unrecoverable upload failure while attempting to send ping ${r}. Error was: ${i??"no status"}.`,f.Warn),this.pingsDatabase.deletePing(r);return}g(Te,[`Recoverable upload failure while attempting to send ping ${r}, will retry.`,`Error was: ${i??"no status"}.`],f.Warn),this.recoverableFailureCount++,this.enqueuePing(e)}clearPendingPingsQueue(){this.queue=this.queue.filter(e=>rt(e))}blockUploads(){this.worker.blockUploading()}resumeUploads(){this.worker.resumeUploading()}update(e,n){this.enqueuePing({identifier:e,...n}),this.worker.isBlocking||(this.processing.delete(e),this.pingsDatabase.deletePing(e)),this.worker.work(()=>this.getUploadTask(),(r,i)=>this.processPingUploadResponse(r,i))}enqueuePing(e){if(!this.processing.has(e.identifier)){for(const n of this.queue)if(n.identifier===e.identifier)return;this.queue.push(e)}}getUploadTaskInternal(){if(this.recoverableFailureCount>=this.policy.maxRecoverableFailures)return g(Te,"Glean has reached maximum recoverable upload failures for the current uploading window.",f.Debug),Se.done();if(this.queue.length>0){const{state:e,remainingTime:n}=this.rateLimiter.getState();if(e===1)return g(Te,["Glean is currently throttled.",`Pending pings may be uploaded in ${(n||0)/1e3}s.`],f.Debug),this.waitAttemptCount++,this.waitAttemptCount>this.policy.maxWaitAttempts?Se.done():Se.wait(n||0);const r=this.queue.shift();return this.processing.add(r.identifier),Se.upload(r)}return Se.done()}}const fr=dr;class gr extends we{constructor(e){super(e)}validate(e){return{type:S.Success}}payload(){return this.inner}}const hr=16,Ut=61,pr="__other__",mr=/^[a-z_][a-z0-9_-]{0,29}(\.[a-z_][a-z0-9_-]{0,29})*$/;function it(t,e){return`${t}/${e}`}function br(t){return t.split("/")[0]}function wr(t){if(t.dynamicLabel===void 0)throw new Error("This point should never be reached.");const e=it(t.baseIdentifier(),t.dynamicLabel);for(const i of t.sendInPings)if(s.metricsDatabase.hasMetric(t.lifetime,i,t.type,e))return e;let n=0;for(const i of t.sendInPings)n+=s.metricsDatabase.countByBaseIdentifier(t.lifetime,i,t.type,t.baseIdentifier());let r=!1;return n>=hr?r=!0:t.dynamicLabel.length>Ut?(r=!0,s.errorManager.record(t,K.InvalidLabel,`Label length ${t.dynamicLabel.length} exceeds maximum of ${Ut}.`)):mr.test(t.dynamicLabel)||(r=!0,s.errorManager.record(t,K.InvalidLabel,`Label must be snake_case, got '${t.dynamicLabel}'.`)),r?it(t.baseIdentifier(),pr):e}class xe{constructor(e,n,r){r&&s.addSupportedMetric(e,r),this.type=e,this.name=n.name,this.category=n.category,this.sendInPings=n.sendInPings,this.lifetime=n.lifetime,this.disabled=n.disabled,this.dynamicLabel=n.dynamicLabel}baseIdentifier(){return this.category.length>0?`${this.category}.${this.name}`:this.name}identifier(){const e=this.baseIdentifier();return X(this.dynamicLabel)?e:wr(this)}shouldRecord(e){return e&&!this.disabled}testGetNumRecordedErrors(e,n=this.sendInPings[0]){return oe("testGetNumRecordedErrors")?s.errorManager.testGetNumRecordedErrors(this,e,n):0}}const vr="Glean.core.Metrics.utils";function ht(t,e){t.startsWith("labeled_")&&s.addSupportedMetric(t,gr);const n=s.getSupportedMetric(t);if(!n)throw new Error(`Unable to create metric of unknown type "${t}".`);return new n(e)}function Lt(t,e){try{return ht(t,e),!0}catch(n){return g(vr,n.message,f.Error),!1}}function yr(t,e=!0){return Kt(t)?(e?t<0:t<=0)?{type:S.Error,errorMessage:`Expected positive value, got ${JSON.stringify(t)}`,errorType:K.InvalidValue}:{type:S.Success}:{type:S.Error,errorMessage:`Expected integer value, got ${JSON.stringify(t)}`}}function pt(t){return L(t)?{type:S.Success}:{type:S.Error,errorMessage:`Expected string value, got ${JSON.stringify(t)}`}}const Er="core.metrics.UUIDMetricType",Sr=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;class Gt extends we{constructor(e){super(e)}validate(e){const n=pt(e);if(n.type===S.Error)return n;const r=e;return Sr.test(r)?{type:S.Success}:{type:S.Error,errorMessage:`"${r}" is not a valid UUID`,errorType:K.InvalidValue}}payload(){return this.inner}}class Nt extends xe{constructor(e){super("uuid",e,Gt)}set(e){if(!this.shouldRecord(s.uploadEnabled))return;e||(e=Re());let n;try{n=new Gt(e),s.metricsDatabase.record(this,n)}catch(r){r instanceof Y&&r.recordError(this)}}generateAndSet(){if(!this.shouldRecord(s.uploadEnabled))return;const e=Re();return this.set(e),e}testGetValue(e=this.sendInPings[0]){if(oe("testGetValue",Er))return s.metricsDatabase.getMetric(e,this)}}var P;(function(t){t.Nanosecond="nanosecond",t.Microsecond="microsecond",t.Millisecond="millisecond",t.Second="second",t.Minute="minute",t.Hour="hour",t.Day="day"})(P||(P={}));const Tr="core.metrics.DatetimeMetricType";function Ir(t){const e=t/60*-1,n=e>0?"+":"-",r=Math.abs(e).toString().padStart(2,"0");return`${n}${r}:00`}class B extends we{constructor(e){super(e)}static fromDate(e,n){if(!(e instanceof Date))throw new Y(`Expected Date object, got ${JSON.stringify(e)}`);return new B({timeUnit:n,timezone:e.getTimezoneOffset(),date:e.toISOString()})}static fromRawDatetime(e,n,r){return new B({timeUnit:r,timezone:n,date:e})}get date(){return new Date(this.inner.date)}get timezone(){return this.inner.timezone}get timeUnit(){return this.inner.timeUnit}get dateISOString(){return this.inner.date}validate(e){if(!U(e)||Object.keys(e).length!==3)return{type:S.Error,errorMessage:`Expected Glean datetime metric object, got ${JSON.stringify(e)}`};const n="timeUnit"in e&&L(e.timeUnit)&&Object.values(P).includes(e.timeUnit),r="timezone"in e&&Oe(e.timezone),i="date"in e&&L(e.date)&&e.date.length===24&&!isNaN(Date.parse(e.date));return!n||!r||!i?{type:S.Error,errorMessage:`Invalid property on datetime metric, got ${JSON.stringify(e)}`}:{type:S.Success}}payload(){const e=this.dateISOString.match(/\d+/g);if(!e||e.length<0)throw new Error("IMPOSSIBLE: Unable to extract date information from DatetimeMetric.");const n=new Date(parseInt(e[0]),parseInt(e[1])-1,parseInt(e[2]),parseInt(e[3])-this.timezone/60,parseInt(e[4]),parseInt(e[5]),parseInt(e[6])),r=Ir(this.timezone),i=n.getFullYear().toString().padStart(2,"0"),a=(n.getMonth()+1).toString().padStart(2,"0"),o=n.getDate().toString().padStart(2,"0");if(this.timeUnit===P.Day)return`${i}-${a}-${o}${r}`;const c=n.getHours().toString().padStart(2,"0");if(this.timeUnit===P.Hour)return`${i}-${a}-${o}T${c}${r}`;const l=n.getMinutes().toString().padStart(2,"0");if(this.timeUnit===P.Minute)return`${i}-${a}-${o}T${c}:${l}${r}`;const d=n.getSeconds().toString().padStart(2,"0");if(this.timeUnit===P.Second)return`${i}-${a}-${o}T${c}:${l}:${d}${r}`;const u=n.getMilliseconds().toString().padStart(3,"0");return this.timeUnit===P.Millisecond?`${i}-${a}-${o}T${c}:${l}:${d}.${u}${r}`:this.timeUnit===P.Microsecond?`${i}-${a}-${o}T${c}:${l}:${d}.${u}000${r}`:`${i}-${a}-${o}T${c}:${l}:${d}.${u}000000${r}`}}class st extends xe{constructor(e,n){super("datetime",e,B),this.timeUnit=n}set(e){if(!this.shouldRecord(s.uploadEnabled))return;const n=this.truncateDate(e);try{const r=B.fromDate(n,this.timeUnit);s.metricsDatabase.record(this,r)}catch(r){r instanceof Y&&r.recordError(this)}}truncateDate(e){e||(e=new Date);const n=e;switch(this.timeUnit){case P.Day:n.setMilliseconds(0),n.setSeconds(0),n.setMinutes(0),n.setMilliseconds(0);case P.Hour:n.setMilliseconds(0),n.setSeconds(0),n.setMinutes(0);case P.Minute:n.setMilliseconds(0),n.setSeconds(0);case P.Second:n.setMilliseconds(0)}return n}setRaw(e,n,r){if(this.shouldRecord(s.uploadEnabled))try{const i=B.fromRawDatetime(e,n,r);s.metricsDatabase.record(this,i)}catch(i){i instanceof Y&&i.recordError(this)}}testGetValueAsDatetimeMetric(e,n){if(oe(n,Tr)){const r=s.metricsDatabase.getMetric(e,this);if(r)return new B(r)}}testGetValueAsString(e=this.sendInPings[0]){const n=this.testGetValueAsDatetimeMetric(e,"testGetValueAsString");return n?n.payload():void 0}testGetValue(e=this.sendInPings[0]){const n=this.testGetValueAsDatetimeMetric(e,"testGetValue");return n?n.date:void 0}}const Dr="core.metrics.StringMetricType",Pr=100;class Rt extends we{constructor(e){super(e)}validate(e){return pt(e)}payload(){return this.inner}}class se extends xe{constructor(e){super("string",e,Rt)}set(e){if(this.shouldRecord(s.uploadEnabled))try{const n=Ht(this,e,Pr),r=new Rt(n);s.metricsDatabase.record(this,r)}catch(n){n instanceof Y&&n.recordError(this)}}testGetValue(e=this.sendInPings[0]){if(oe("testGetValue",Dr))return s.metricsDatabase.getMetric(e,this)}}const Ct="core.metrics.CounterMetricType";class at extends we{constructor(e){super(e)}validate(e){return yr(e,!1)}payload(){return this.inner}saturatingAdd(e){const n=this.validateOrThrow(e);this.inner=$n(this.inner,n)}}class Ve extends xe{constructor(e){super("counter",e,at)}add(e){if(this.shouldRecord(s.uploadEnabled)){X(e)&&(e=1);try{s.metricsDatabase.transform(this,this.transformFn(e))}catch(n){n instanceof Y&&n.recordError(this)}}}transformFn(e){return n=>{const r=new at(e);if(n)try{r.saturatingAdd(n)}catch{g(Ct,`Unexpected value found in storage for metric ${this.name}: ${JSON.stringify(n)}. Overwriting.`)}return r}}testGetValue(e=this.sendInPings[0]){if(oe("testGetValue",Ct))return s.metricsDatabase.getMetric(e,this)}}function _r(t=30){const e=localStorage.getItem("glean_session_last_active"),n=new Date(Number(e)),r=new Date;return r.setMinutes(r.getMinutes()-t),r>n}const Mr="core.InternalMetrics";class Ar{constructor(){this.clientId=new Nt({name:"client_id",category:"",sendInPings:["glean_client_info"],lifetime:"user",disabled:!1}),this.firstRunDate=new st({name:"first_run_date",category:"",sendInPings:["glean_client_info"],lifetime:"user",disabled:!1},P.Day),this.os=new se({name:"os",category:"",sendInPings:["glean_client_info"],lifetime:"application",disabled:!1}),this.osVersion=new se({name:"os_version",category:"",sendInPings:["glean_client_info"],lifetime:"application",disabled:!1}),this.architecture=new se({name:"architecture",category:"",sendInPings:["glean_client_info"],lifetime:"application",disabled:!1}),this.locale=new se({name:"locale",category:"",sendInPings:["glean_client_info"],lifetime:"application",disabled:!1}),this.appChannel=new se({name:"app_channel",category:"",sendInPings:["glean_client_info"],lifetime:"application",disabled:!1}),this.appBuild=new se({name:"app_build",category:"",sendInPings:["glean_client_info"],lifetime:"application",disabled:!1}),this.appDisplayVersion=new se({name:"app_display_version",category:"",sendInPings:["glean_client_info"],lifetime:"application",disabled:!1}),this.buildDate=new st({name:"build_date",category:"",sendInPings:["glean_client_info"],lifetime:"application",disabled:!1},"second"),this.sessionId=new Nt({name:"session_id",category:"",sendInPings:["glean_client_info"],lifetime:"user",disabled:!1}),this.sessionCount=new Ve({name:"session_count",category:"",sendInPings:["glean_client_info"],lifetime:"user",disabled:!1})}initialize(e){!s.testing&&Pe()||(e&&localStorage.getItem("GLEAN_MIGRATION_FLAG")!=="1"?(this.migrateCoreMetricsFromIdb(),localStorage.setItem("GLEAN_MIGRATION_FLAG","1")):this.initializeUserLifetimeMetrics(),this.updateSessionInfo(),this.os.set(s.platform.info.os()),this.osVersion.set(s.platform.info.osVersion()),this.architecture.set(s.platform.info.arch()),this.locale.set(s.platform.info.locale()),this.appBuild.set(s.config.appBuild||"Unknown"),this.appDisplayVersion.set(s.config.appDisplayVersion||"Unknown"),s.config.channel&&this.appChannel.set(s.config.channel),s.config.buildDate&&this.buildDate.set())}updateSessionInfo(){if(Pe())return;if(s.metricsDatabase.getMetric(he,this.sessionId))try{_r(s.config.sessionLengthInMinutesOverride)&&this.generateNewSession()}catch{this.generateNewSession()}else this.generateNewSession();localStorage.setItem("glean_session_last_active",Date.now().toString())}initializeClientId(){let e=!1;const n=s.metricsDatabase.getMetric(he,this.clientId);if(n)try{ht("uuid",n).payload()===Qe&&(e=!0)}catch{g(Mr,"Unexpected value found for Glean clientId. Ignoring.",f.Warn),e=!0}else e=!0;e&&this.clientId.set(Re())}initializeFirstRunDate(){s.metricsDatabase.getMetric(he,this.firstRunDate)||this.firstRunDate.set()}generateNewSession(){this.sessionId.generateAndSet(),this.sessionCount.add()}initializeUserLifetimeMetrics(){this.initializeClientId(),this.initializeFirstRunDate()}migrateCoreMetricsFromIdb(){const e=window.indexedDB.open("Glean");e.onerror=()=>{this.initializeUserLifetimeMetrics()},e.onsuccess=()=>{try{const n=e.result,a=(n?.transaction("Main","readwrite")).objectStore("Main").get("userLifetimeMetrics");a.onsuccess=()=>{var o,c,l,d,u,m;const b=(l=(c=(o=a.result)===null||o===void 0?void 0:o.glean_client_info)===null||c===void 0?void 0:c.uuid)===null||l===void 0?void 0:l.client_id;b?this.clientId.set(b):this.initializeClientId();const h=(m=(u=(d=a.result)===null||d===void 0?void 0:d.glean_client_info)===null||u===void 0?void 0:u.datetime)===null||m===void 0?void 0:m.first_run_date;h?this.firstRunDate.setRaw(h.date,h.timezone,h.timeUnit):this.initializeFirstRunDate()},a.onerror=()=>{this.initializeUserLifetimeMetrics()}}catch{this.initializeUserLifetimeMetrics()}}}}const $e="core.Pings.Maker";function $r(t,e){return`/submit/${s.applicationId}/${e.name}/${Cn}/${t}`}function Or(){const t={};if(s.config.debugViewTag&&(t["X-Debug-ID"]=s.config.debugViewTag),s.config.sourceTags&&(t["X-Source-Tags"]=s.config.sourceTags.toString()),Object.keys(t).length>0)return t}function xr(t){const e=new st({category:"",name:`${t.name}#start`,sendInPings:[Ce],lifetime:"user",disabled:!1},P.Minute),n=s.metricsDatabase.getMetric(Ce,e);let r;return n?r=new B(n):r=B.fromDate(s.startTime,P.Minute),{startTimeMetric:e,startTime:r}}function Ur(t){const e=new Ve({category:"",name:`${t.name}#sequence`,sendInPings:[Ce],lifetime:"user",disabled:!1}),n=s.metricsDatabase.getMetric(Ce,e);if(e.add(1),n)try{return new at(n).payload()}catch{g($e,`Unexpected value found for sequence number in ping ${t.name}. Ignoring.`,f.Warn)}return 0}function Lr(t){const{startTimeMetric:e,startTime:n}=xr(t),r=new Date;e.set(r);const i=B.fromDate(r,P.Minute);return{startTime:n.payload(),endTime:i.payload()}}function Gr(t,e){const n=Ur(t),{startTime:r,endTime:i}=Lr(t),a={seq:n,start_time:r,end_time:i};return e&&(a.reason=e),a}function Nr(t){let e=s.metricsDatabase.getPingMetrics(he,!0);e||(g($e,"Empty client info data. Will submit anyways.",f.Warn),e={});let n={telemetry_sdk_build:Yt};for(const r in e)n={...n,...e[r]};return t.includeClientId||(delete n.client_id,delete n.session_id),n}function Rr(t,e){const n=s.eventsDatabase.getPingEvents(t.name,!0);let r=s.metricsDatabase.getPingMetrics(t.name,!0);if(!r&&!n){if(!t.sendIfEmpty){g($e,`Storage for ${t.name} empty. Bailing out.`,f.Info);return}g($e,`Storage for ${t.name} empty. Ping will still be sent.`,f.Info)}t.includeClientId&&s.config.experimentationId&&(r!=null?r.string["glean.client.annotation.experimentation_id"]=s.config.experimentationId:r={string:{"glean.client.annotation.experimentation_id":s.config.experimentationId}});const i=r?{metrics:r}:{},a=n?{events:n}:{},o=Gr(t,e),c=Nr(t);return{...i,...a,ping_info:o,client_info:c}}function Cr(t,e,n){const r=Rr(e,n);if(!r)return;s.config.logPings&&g($e,JSON.stringify(r,null,2),f.Info);const i=Or();s.pingsDatabase.recordPing($r(t,e),t,r,i)}const fe="core.Pings.PingType";function zr(t){return t===lt}class zt{constructor(e){var n;this.name=e.name,this.includeClientId=e.includeClientId,this.sendIfEmpty=e.sendIfEmpty,this.reasonCodes=(n=e.reasonCodes)!==null&&n!==void 0?n:[],this.preciseTimestamps=e.preciseTimestamps}submit(e){this.testCallback?this.testCallback(e).then(()=>{this.internalSubmit(e,this.resolveTestPromiseFunction)}).catch(n=>{g(fe,[`There was an error validating "${this.name}" (${e??"no reason"}):`,n],f.Error),this.internalSubmit(e,this.rejectTestPromiseFunction)}):this.internalSubmit(e)}internalSubmit(e,n){if(!s.initialized){g(fe,"Glean must be initialized before submitting pings.",f.Info);return}if(!s.uploadEnabled&&!zr(this.name)){g(fe,"Glean disabled: not submitting pings. Glean may still submit the deletion-request ping.",f.Info);return}let r=e;e&&!this.reasonCodes.includes(e)&&(g(fe,`Invalid reason code ${e} from ${this.name}. Ignoring.`,f.Warn),r=void 0);const i=Re();Cr(i,this,r),n&&(n(),this.resolveTestPromiseFunction=void 0,this.rejectTestPromiseFunction=void 0,this.testCallback=void 0)}async testBeforeNextSubmit(e){if(oe("testBeforeNextSubmit",fe)){if(this.testCallback){g(fe,`There is an existing test call for ping "${this.name}". Ignoring.`,f.Error);return}return new Promise((n,r)=>{this.resolveTestPromiseFunction=n,this.rejectTestPromiseFunction=r,this.testCallback=e})}}}class Vr{constructor(){this.deletionRequest=new zt({name:lt,includeClientId:!0,sendIfEmpty:!0,reasonCodes:["at_init","set_upload_enabled"]}),this.events=new zt({name:re,includeClientId:!0,sendIfEmpty:!1,reasonCodes:["startup","max_capacity"]})}}const Ge="core.Metrics.Database",cn="reserved#",Fr=`glean.${cn}`;function Br(t){return{category:"glean",name:`${cn}${t}`}}function kr(t){const e={};for(const n in t){const r=t[n];e[n]={};for(const i in r){const a=ht(n,r[i]);e[n][i]=a.payload()}}return e}class jr{constructor(){this.userStore=new s.platform.Storage("userLifetimeMetrics"),this.pingStore=new s.platform.Storage("pingLifetimeMetrics"),this.appStore=new s.platform.Storage("appLifetimeMetrics")}record(e,n){this.transform(e,()=>n)}transform(e,n){if(e.disabled)return;const r=this.chooseStore(e.lifetime),i=e.identifier();for(const a of e.sendInPings){const o=c=>n(c).get();r.update([a,e.type,i],o)}}hasMetric(e,n,r,i){const o=this.chooseStore(e).get([n,r,i]);return!X(o)}countByBaseIdentifier(e,n,r,i){const o=this.chooseStore(e).get([n,r]);return X(o)?0:Object.keys(o).filter(c=>c.startsWith(i)).length}getMetric(e,n){const r=this.chooseStore(n.lifetime),i=n.identifier(),a=r.get([e,n.type,i]);if(!X(a)&&!Lt(n.type,a)){g(Ge,`Unexpected value found for metric ${i}: ${JSON.stringify(a)}. Clearing.`,f.Error),r.delete([e,n.type,i]);return}else return a}getPingMetrics(e,n){const r=this.getCorrectedPingData(e,"user"),i=this.getCorrectedPingData(e,"ping"),a=this.getCorrectedPingData(e,"application");n&&Object.keys(i).length>0&&this.clear("ping",e);const o={};for(const c of[r,i,a])for(const l in c)for(const d in c[l])d.startsWith(Fr)||(d.includes("/")?this.processLabeledMetric(o,l,d,c[l][d]):o[l]={...o[l],[d]:c[l][d]});if(Object.keys(o).length!==0)return kr(o)}clear(e,n){const r=this.chooseStore(e),i=n?[n]:[];r.delete(i)}clearAll(){this.userStore.delete([]),this.pingStore.delete([]),this.appStore.delete([])}chooseStore(e){switch(e){case"user":return this.userStore;case"ping":return this.pingStore;case"application":return this.appStore}}getCorrectedPingData(e,n){const r=this.chooseStore(n),i=r.get([e]);if(X(i))return{};if(!U(i))return g(Ge,`Invalid value found in storage for ping "${e}". Deleting.`,f.Debug),r.delete([e]),{};const a={};for(const o in i){const c=i[o];if(!U(c)){g(Ge,`Unexpected data found in storage for metrics of type "${o}" in ping "${e}". Deleting.`,f.Debug),r.delete([e,o]);continue}for(const l in c){if(!Lt(o,c[l])){g(Ge,`Invalid value "${JSON.stringify(c[l])}" found in storage for metric "${l}". Deleting.`,f.Debug),r.delete([e,o,l]);continue}a[o]||(a[o]={}),a[o][l]=c[l]}}return a}processLabeledMetric(e,n,r,i){const a=`labeled_${n}`,o=r.split("/",2),c=o[0],l=o[1];if(a in e&&c in e[a]){const d=e[a][c];e[a][c]={...d,[l]:i}}else e[a]={...e[a],[c]:{[l]:i}}}}class be extends we{constructor(e){super(e)}static withTransformedExtras(e,n){const r=e.extra||{},i=n(r);return{category:e.category,name:e.name,timestamp:e.timestamp,extra:i&&Object.keys(i).length>0?i:void 0}}addExtra(e,n){this.inner.extra||(this.inner.extra={}),this.inner.extra[e]=n}withoutReservedExtras(){return be.withTransformedExtras(this.get(),e=>Object.keys(e).filter(n=>!Vn.includes(n)).reduce((n,r)=>(n[r]=e[r],n),{}))}validate(e){if(!U(e))return{type:S.Error,errorMessage:`Expected Glean event object, got ${typeof e}`};const n="category"in e&&L(e.category),r="name"in e&&L(e.name);if(!n||!r)return{type:S.Error,errorMessage:`Unexpected value for "category" or "name" in event object: ${JSON.stringify(e)}`};if(!("timestamp"in e&&Kt(e.timestamp)&&e.timestamp>=0))return{type:S.Error,errorMessage:`Event timestamp must be a positive integer, got ${JSON.stringify(e)}`};if(e.extra){if(!U(e.extra))return{type:S.Error,errorMessage:`Expected Glean extras object, got ${typeof e}`};for(const[a,o]of Object.entries(e.extra)){const c=pt(a);if(c.type===S.Error)return c;if(!L(o)&&!Oe(o)&&!Ne(o))return{type:S.Error,errorMessage:`Unexpected value for extra key ${a}: ${JSON.stringify(o)}`}}}return{type:S.Success}}payload(){return be.withTransformedExtras(this.withoutReservedExtras(),e=>Object.keys(e).reduce((n,r)=>(n[r]=e[r].toString(),n),{}))}}var Wr=function(t,e,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(t,n):i?i.value=n:e.set(t,n),n},Ie=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},ne;const qr="core.metrics.EventMetricType",Jr=500;class ln extends xe{constructor(e,n){super("event",e),this.allowedExtraKeys=n}record(e,n=Ye()){if(!this.shouldRecord(s.uploadEnabled))return;const r=Date.now();try{const i=new be({category:this.category,name:this.name,timestamp:n,extra:e}),a={};if(e&&this.allowedExtraKeys)for(const[o,c]of Object.entries(e))if(this.allowedExtraKeys.includes(o))L(c)?a[o]=Ht(this,c,Jr):a[o]=c;else{s.errorManager.record(this,K.InvalidValue,`Invalid key index: ${o}`);continue}a.glean_timestamp=r.toString(),i.set({...i.get(),extra:a}),s.eventsDatabase.record(this,i)}catch(i){i instanceof Y&&i.recordError(this)}}testGetValue(e=this.sendInPings[0]){if(oe("testGetValue",qr)){const n=s.eventsDatabase.getEvents(e,this);return n&&(n.forEach(r=>{r.extra&&(delete r.extra.glean_timestamp,Object.keys(r.extra).length==0&&(r.extra=void 0))}),n)}}}class Vt{constructor(e,n){ne.set(this,void 0),Wr(this,ne,new ln(e,n),"f")}record(e){Ie(this,ne,"f").record(e)}testGetValue(e=Ie(this,ne,"f").sendInPings[0]){return Ie(this,ne,"f").testGetValue(e)}testGetNumRecordedErrors(e,n=Ie(this,ne,"f").sendInPings[0]){return Ie(this,ne,"f").testGetNumRecordedErrors(e,n)}}ne=new WeakMap;const Ft="core.Metric.EventsDatabase";function Bt(t,e=s.startTime){un(t).record({[me]:e.toISOString()},0)}function kt(t){L(t)||(t="");const e=new Date(t);if(isNaN(e.getTime()))throw new Error(`Error attempting to generate Date object from string: ${t}`);return e}function jt(t){return new Ve({...Br("execution_counter"),sendInPings:t.filter(e=>e!==re),lifetime:"ping",disabled:!1})}function un(t){return new ln({category:"glean",name:"restarted",sendInPings:t.filter(e=>e!==re),lifetime:"ping",disabled:!1},[me])}function Xr(t){var e,n;return!!(!((n=(e=t?.get())===null||e===void 0?void 0:e.extra)===null||n===void 0)&&n[me])}function Kr(t){for(;t.length&&Xr(t[t.length-1]);)t.pop();return t}class Hr{constructor(){this.initialized=!1,this.eventsStore=new s.platform.Storage("events")}initialize(){var e;if(this.initialized)return;const n=this.getAvailableStoreNames();if(n.includes(re)){const r=(e=this.eventsStore.get([re]))!==null&&e!==void 0?e:[];r.length>0&&r.length>=s.config.maxEvents&&s.corePings.events.submit("startup")}jt(n).add(1),Bt(n),this.initialized=!0}record(e,n){if(!e.disabled)for(const r of e.sendInPings){const i=jt([r]);let a=s.metricsDatabase.getMetric(r,i);a||(i.add(1),a=1,Bt([r],new Date)),n.addExtra(De,a);let o=0;const c=l=>{var d;const u=(d=l)!==null&&d!==void 0?d:[];return u.push(n.get()),o=u.length,u};this.eventsStore.update([r],c),r===re&&o>=s.config.maxEvents&&s.corePings.events.submit("max_capacity")}}getEvents(e,n){const r=this.getAndValidatePingData(e);if(r.length!==0)return r.filter(i=>i.get().category===n.category&&i.get().name===n.name).map(i=>i.withoutReservedExtras())}getPingEvents(e,n){const r=this.getAndValidatePingData(e);if(n&&Object.keys(r).length>0&&this.eventsStore.delete([e]),r.length===0)return;const i=this.prepareEventsPayload(e,r);if(i.length>0)return i}clearAll(){this.eventsStore.delete([])}getAvailableStoreNames(){const e=this.eventsStore.get([]);return X(e)?[]:Object.keys(e)}getAndValidatePingData(e){const n=this.eventsStore.get([e]);return X(n)?[]:Array.isArray(n)?n.reduce((r,i)=>{try{const a=new be(i);return[...r,a]}catch{return g(Ft,`Unexpected data found in events storage: ${JSON.stringify(i)}. Ignoring.`),r}},[]):(g(Ft,`Unexpected value found for ping ${e}: ${JSON.stringify(n)}. Clearing.`,f.Error),this.eventsStore.delete([e]),[])}prepareEventsPayload(e,n){var r,i,a,o;let c=n.sort((m,b)=>{var h,v;const p=Number((h=m.get().extra)===null||h===void 0?void 0:h[De]),T=Number((v=b.get().extra)===null||v===void 0?void 0:v[De]);return p!==T?p-T:m.get().timestamp-b.get().timestamp}),l;try{l=kt((r=c[0].get().extra)===null||r===void 0?void 0:r[me]),c.shift()}catch{l=s.startTime}const d=((i=c[0])===null||i===void 0?void 0:i.get().timestamp)||0;let u=0;for(const[m,b]of c.entries()){try{const p=kt((a=b.get().extra)===null||a===void 0?void 0:a[me]),T=p.getTime()-l.getTime();l=p;const j=u+T,G=c[m-1].get().timestamp;j<=G?(u=G+1,s.errorManager.record(un([e]),K.InvalidValue,`Invalid time offset between application sessions found for ping "${e}". Ignoring.`)):u=j}catch{}const h=Number(((o=b.get().extra)===null||o===void 0?void 0:o[De])||1);let v;h===1?v=b.get().timestamp-d:v=b.get().timestamp+u,c[m]=new be({category:b.get().category,name:b.get().name,timestamp:v,extra:b.get().extra})}return c=Kr(c),c.map(m=>m.payload())}}function Yr(t){return`core.metrics.${t.type.charAt(0).toUpperCase()+t.type.slice(1)}`}function Wt(t,e){const n=t.baseIdentifier(),r=br(n);return new Ve({name:it(e,r),category:"glean.error",lifetime:"ping",sendInPings:t.sendInPings,disabled:!1})}class Qr{record(e,n,r,i=1){const a=Wt(e,n);g(Yr(e),[`${e.baseIdentifier()}:`,r]),i>0&&a.add(i)}testGetNumRecordedErrors(e,n,r){return Wt(e,n).testGetValue(r)||0}}const qt="core.glean_metrics";var ot;(function(t){const e={pageLoad:new Vt({category:"glean",name:"page_load",sendInPings:[re],lifetime:"ping",disabled:!1},["url","referrer","title"]),elementClick:new Vt({category:"glean",name:"element_click",sendInPings:[re],lifetime:"ping",disabled:!1},["id","type","label"])};function n(o){var c,l,d;if(!s.initialized){g(qt,"Attempted to record a page load event before Glean was initialized. This is a no-op.",f.Warn);return}e.pageLoad.record({url:(c=o?.url)!==null&&c!==void 0?c:typeof window<"u"?window.location.href:"URL_NOT_PROVIDED_OR_AVAILABLE",referrer:(l=o?.referrer)!==null&&l!==void 0?l:typeof document<"u"?document.referrer:"REFERRER_NOT_PROVIDED_OR_AVAILABLE",title:(d=o?.title)!==null&&d!==void 0?d:typeof document<"u"?document.title:"TITLE_NOT_PROVIDED_OR_AVAILABLE"})}t.pageLoad=n;function r(o){const c=o.dataset;return{...c.gleanId&&{id:c.gleanId},...c.gleanType&&{type:c.gleanType},...c.gleanLabel&&{label:c.gleanLabel}}}function i(o){const l=o.target.closest("[data-glean-id], [data-glean-type], [data-glean-label]");if(!l)return;const d=r(l);a(d)}t.handleClickEvent=i;function a(o){if(!s.initialized){g(qt,"Attempted to record element click event before Glean was initialized. This is a no-op.",f.Warn);return}e.elementClick.record(o)}t.recordElementClick=a})(ot||(ot={}));const Jt=ot,te="core.Glean";var k;(function(t){t.DebugTag="DebugTag",t.SourceTags="SourceTags",t.LogPings="LogPings"})(k||(k={}));const Ke=(t,e)=>{const n=`Glean.${t.toString()}`;switch(t){case k.DebugTag:sessionStorage.setItem(n,e);break;case k.LogPings:sessionStorage.setItem(n,e.toString());break;case k.SourceTags:sessionStorage.setItem(n,e.join(","));break}},He=t=>sessionStorage.getItem(`Glean.${t.toString()}`)||void 0;var pe;(function(t){function e(){s.uploadEnabled=!0,t.pingUploader.resumeUploads()}function n(h){s.coreMetrics.initialize(h)}function r(h){let v;h?v="at_init":v="set_upload_enabled",s.uploadEnabled=!1,s.corePings.deletionRequest.submit(v),i()}function i(){t.pingUploader.clearPendingPingsQueue();let h;try{h=new B(s.metricsDatabase.getMetric(he,s.coreMetrics.firstRunDate)).date}catch{h=new Date}s.eventsDatabase.clearAll(),s.metricsDatabase.clearAll(),s.pingsDatabase.clearAll(),s.uploadEnabled=!0,s.coreMetrics.clientId.set(Qe),s.coreMetrics.firstRunDate.set(h),s.uploadEnabled=!1}function a(){if(typeof window>"u"||typeof window.sessionStorage>"u")return;const h=He(k.LogPings);h&&(t.preInitLogPings=_n(h));const v=He(k.DebugTag);v&&(t.preInitDebugViewTag=v);const p=He(k.SourceTags);p&&(t.preInitSourceTags=p.split(","))}function o(h,v,p){if(s.initialized){g(te,"Attempted to initialize Glean, but it has already been initialized. Ignoring.",f.Warn);return}if(!L(h)){g(te,"Unable to initialize Glean, applicationId must be a string.",f.Error);return}if(!Ne(v)){g(te,"Unable to initialize Glean, uploadEnabled must be a boolean.",f.Error);return}if(h.length===0){g(te,"Unable to initialize Glean, applicationId cannot be an empty string.",f.Error);return}if(!s.platform){g(te,"Unable to initialize Glean, platform has not been set.",f.Error);return}if(s.coreMetrics=new Ar,s.corePings=new Vr,s.applicationId=Mn(h),s.config=new Bn(p),a(),t.preInitLogPings&&(s.config.logPings=t.preInitLogPings),t.preInitDebugViewTag&&(s.config.debugViewTag=t.preInitDebugViewTag),t.preInitSourceTags&&(s.config.sourceTags=t.preInitSourceTags),s.metricsDatabase=new jr,s.eventsDatabase=new Hr,s.pingsDatabase=new rr,s.errorManager=new Qr,t.pingUploader=new fr(s.config,s.pingsDatabase),s.initialized=!0,s.uploadEnabled=v,s.eventsDatabase.initialize(),v)s.metricsDatabase.clear("application"),e(),n(p?.migrateFromLegacyStorage),p?.enableAutoPageLoadEvents&&Jt.pageLoad(),p?.enableAutoElementClickEvents&&document.addEventListener("click",T=>{Jt.handleClickEvent(T)});else{const T=s.metricsDatabase.getMetric(he,s.coreMetrics.clientId);T?T!==Qe&&r(!0):i()}s.pingsDatabase.scanPendingPings()}t.initialize=o;function c(h){if(!s.initialized){g(te,[`Changing upload enabled before Glean is initialized is not supported.
`,"Pass the correct state into `initialize`.\n","See documentation at https://mozilla.github.io/glean/book/user/general-api.html#initializing-the-glean-sdk`"],f.Error);return}if(!Ne(h)){g(te,"Unable to change upload state, new value must be a boolean. Ignoring.",f.Error);return}s.uploadEnabled!==h&&(h?(e(),n(s.config.migrateFromLegacyStorage)):r(!1))}t.setUploadEnabled=c;function l(h){s.config.experimentationId=h}t.setExperimentationId=l;function d(h){s.initialized?s.config.logPings=h:t.preInitLogPings=h}t.setLogPings=d;function u(h){s.initialized?s.config.debugViewTag=h:t.preInitDebugViewTag=h}t.setDebugViewTag=u;function m(h){s.initialized?s.config.sourceTags=h:t.preInitSourceTags=h}t.setSourceTags=m;function b(h){s.initialized||(s.isPlatformSet()&&s.platform.name!==h.name&&!s.testing&&g(te,[`IMPOSSIBLE: Attempted to change Glean's targeted platform",
            "from "${s.platform.name}" to "${h.name}". Ignoring.`],f.Error),s.platform=h)}t.setPlatform=b})(pe||(pe={}));typeof window<"u"&&typeof window.sessionStorage<"u"&&(window.Glean={setLogPings:t=>{Ke(k.LogPings,t),pe.setLogPings(t),console.log("Pings will be logged to the console until this tab is closed.")},setDebugViewTag:t=>{Ke(k.DebugTag,t),pe.setDebugViewTag(t),console.log("Pings will be sent to the Debug Ping Viewer until this tab is closed. Pings can be found here: https://debug-ping-preview.firebaseapp.com/.")},setSourceTags:t=>{Ke(k.SourceTags,t),pe.setSourceTags(t),console.log("Pings will be given the specified tags until the tab is closed.")}});const ge=pe,Zr=t=>({initialize(e,n,r){ge.setPlatform(t),ge.initialize(e,n,r)},setUploadEnabled(e){ge.setUploadEnabled(e)},setLogPings(e){ge.setLogPings(e)},setDebugViewTag(e){ge.setDebugViewTag(e)},setSourceTags(e){ge.setSourceTags(e)}}),ei=Zr(Rn);export{ei as G,Jt as a};
